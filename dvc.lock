schema: '2.0'
stages:
  prepare:
    cmd: python src/job_post_nlp/prepare.py
    deps:
    - path: data/Jobnet.xlsx
      hash: md5
      md5: 26964e5ea3bf422d0f744b6fab9af448
      size: 13307578
    - path: src/job_post_nlp/prepare.py
      hash: md5
      md5: 08664235a4f9fe3bdc1b77d378d0db74
      size: 11772
    params:
      params.yaml:
        prepare:
          settings:
            nobs: -1
            batch_size: 50
            threads: 4
          preprocessing:
            model: da_core_news_sm
            pipeline:
            - tok2vec
            - lemmatizer
            keep_negations: true
          tdm:
            tdm_cell: binary
            ngram_n: 2
            min_df:
            - 1
            - 0.01
            - 0.01
            - 0.01
            - 0.01
    outs:
    - path: data/corpus.spacy
      hash: md5
      md5: 491ccc10e5d0d28f4a5aaf0962c27913
      size: 45812937
    - path: data/tdm.parquet
      hash: md5
      md5: b072a221825b75b8ca855105480b4975
      size: 33453892
  train:
    cmd: python src/job_post_nlp/train.py
    deps:
    - path: data/tdm.parquet
      hash: md5
      md5: b072a221825b75b8ca855105480b4975
      size: 33453892
    - path: src/job_post_nlp/train.py
      hash: md5
      md5: 2b2deb37b0d8fec18d25c2cac05c30f9
      size: 3211
    params:
      params.yaml:
        train:
          settings:
            verbose: false
            max_iter: 200
            seed: 17
          corex:
            n_topics: 20
            anchors:
            - - fleksibel
              - fleksibilitet
              - hjemme
            - - fleksibel
              - fleksibilitet
              - skiftende
              - vagt
            - - fleksibel
              - fleksibilitet
              - familie
            - - fleksibel
              - fleksibilitet
            - - familie
              - børn
              - familievenlig
            - - udvikling
              - udvikle
              - karriere
            - - udvikling
              - udvikle
              - travl
            - - udvikling
              - udvikle
              - vækst
            - - udvikling
              - udvikle
            anchor_strength: 9
    outs:
    - path: models/corex_model.pkl
      hash: md5
      md5: 2d8153343b2dd66729429b1595dc85df
      size: 79106155
  evaluate:
    cmd: python src/job_post_nlp/evaluate.py
    deps:
    - path: models/corex_model.pkl
      hash: md5
      md5: 2d8153343b2dd66729429b1595dc85df
      size: 79106155
    - path: src/job_post_nlp/evaluate.py
      hash: md5
      md5: b69a313f8f95d2461914e4c1b3ca344f
      size: 6064
