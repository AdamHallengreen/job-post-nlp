schema: '2.0'
stages:
  preprocessing:
    cmd: python .\src\job_post_nlp\preprocess.py
    deps:
    - path: .\data\Jobnet.xlsx
      hash: md5
      md5: 26964e5ea3bf422d0f744b6fab9af448
      size: 13307578
    - path: .\src\job_post_nlp\preprocess.py
      hash: md5
      md5: 4eb6c9d8c1f422fe7eeb41ed97b9b03e
      size: 2643
    params:
      params.yaml:
        preprocess.nobs: 200
    outs:
    - path: .\data\tokenized_texts.json
      hash: md5
      md5: 0a9d5afdc2f26252952fa9f8e9e8e333
      size: 1858145
  most_common:
    cmd: python .\src\job_post_nlp\models\most_common.py
    deps:
    - path: .\data\tokenized_texts.json
      hash: md5
      md5: 0a9d5afdc2f26252952fa9f8e9e8e333
      size: 1858145
    - path: .\src\job_post_nlp\models\most_common.py
      hash: md5
      md5: 3736fd63878b39f6bc17e28d3efd384c
      size: 3875
    params:
      params.yaml:
        most_common.top_n: 10
    outs:
    - path: .\outputs\most_common_words.json
      hash: md5
      md5: 89d9bd93722fbdfaeddd476bc754cb03
      size: 442
    - path: .\outputs\most_common_words_bar_plot.png
      hash: md5
      md5: d3f6cb49e97b488b43f4caa755f2ca9f
      size: 17044
  prepare:
    cmd: python src/job_post_nlp/prepare.py
    deps:
    - path: data/Jobnet.xlsx
      hash: md5
      md5: 26964e5ea3bf422d0f744b6fab9af448
      size: 13307578
    - path: src/job_post_nlp/prepare.py
      hash: md5
      md5: 1e7b5a49cfc428bcdc5dc87baa4ea222
      size: 7990
    params:
      params.yaml:
        prepare:
          settings:
            nobs: 1000
            batch_size: 50
            threads: 4
          preprocessing:
            model: da_core_news_sm
            pipeline:
            - tok2vec
            - lemmatizer
            keep_negations: true
          tdm:
            tdm_cell: binary
            ngram_n: 2
            min_df:
            - 1
            - 0.01
            - 0.01
            - 0.01
            - 0.01
    outs:
    - path: data/corpus.spacy
      hash: md5
      md5: b9dcd3e5e3f19ed0f76bab35b48162c9
      size: 5379956
    - path: data/tdm.parquet
      hash: md5
      md5: a7f21edd92161cf1f37558bdc3edf93d
      size: 10467511
  train:
    cmd: python src/job_post_nlp/train.py
    deps:
    - path: data/tdm.parquet
      hash: md5
      md5: a7f21edd92161cf1f37558bdc3edf93d
      size: 10467511
    - path: src/job_post_nlp/train.py
      hash: md5
      md5: 17e6400f52ac43f0b2632fc28eeedfe1
      size: 3083
    params:
      params.yaml:
        train:
          settings:
            verbose: false
            max_iter: 200
            seed: 17
          corex:
            n_topics: 50
            anchors:
            - - fleksibel
              - fleksibilitet
              - hjemme
            - - fleksibel
              - fleksibilitet
              - hjemme
            - - fleksibel
              - fleksibilitet
              - hjemme
            - - fleksibel
              - fleksibilitet
              - hjemme
            - - fleksibel
              - fleksibilitet
              - hjemme
            - - karriere
              - udvikling
              - ambition
            - - karriere
              - udvikling
              - ambition
            - - karriere
              - udvikling
              - ambition
            - - karriere
              - udvikling
              - ambition
            - - karriere
              - udvikling
              - ambition
            anchor_strength: 4
    outs:
    - path: models/corex_model.pkl
      hash: md5
      md5: d85f9ddb15ef367504ac8c0c1483553d
      size: 60549242
  evaluate:
    cmd: python src/job_post_nlp/evaluate.py
    deps:
    - path: models/corex_model.pkl
      hash: md5
      md5: d85f9ddb15ef367504ac8c0c1483553d
      size: 60549242
    - path: src/job_post_nlp/evaluate.py
      hash: md5
      md5: 691ee573487ed29be6a56e86f4a9c273
      size: 5033
